<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Linking to EVM packages · ZeppelinOS</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Linking to EVM packages · ZeppelinOS"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.zeppelinos.org/index.html"/><meta property="og:description" content="ZeppelinOS allows us to link packages that have been already deployed"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-102575245-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,200,300,400,500,700,400italic,700italic"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.svg" alt="ZeppelinOS"/></a><a href="/versions.html"><h3>2.2.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/start.html" target="_self">Quickstart</a></li><li class=""><a href="/docs/apis.html" target="_self">Reference</a></li><li class=""><a href="https://blog.zeppelinos.org" target="_self">Blog</a></li><li class=""><a href="https://forum.zeppelin.solutions" target="_self">Forum</a></li><li class=""><a href="https://github.com/zeppelinos" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>QUICKSTART</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>OVERVIEW</h3><ul><li class="navListItem"><a class="navItem" href="/docs/start.html">ZeppelinOS</a></li><li class="navListItem"><a class="navItem" href="/docs/new_2.html">What&#x27;s new in ZeppelinOS 2.0</a></li><li class="navListItem"><a class="navItem" href="/docs/new_2.2.html">What&#x27;s new in ZeppelinOS 2.2</a></li></ul></div><div class="navGroup navGroupActive"><h3>QUICKSTART</h3><ul><li class="navListItem"><a class="navItem" href="/docs/zepkit.html">ZepKit</a></li><li class="navListItem"><a class="navItem" href="/docs/deploying.html">Deploying your first project</a></li><li class="navListItem"><a class="navItem" href="/docs/upgrading.html">Upgrading your project</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/linking.html">Linking to EVM packages</a></li><li class="navListItem"><a class="navItem" href="/docs/publishing.html">Publishing an EVM package</a></li><li class="navListItem"><a class="navItem" href="/docs/vouching.html">Vouching for EVM packages</a></li></ul></div><div class="navGroup navGroupActive"><h3>GUIDES</h3><ul><li class="navListItem"><a class="navItem" href="/docs/writing_contracts.html">Writing upgradeable contracts</a></li><li class="navListItem"><a class="navItem" href="/docs/testing.html">Testing upgradeable projects</a></li><li class="navListItem"><a class="navItem" href="/docs/erc20_onboarding.html">Onboarding ERC20 tokens</a></li><li class="navListItem"><a class="navItem" href="/docs/upgrades_governance.html">Upgrades governance</a></li><li class="navListItem"><a class="navItem" href="/docs/zos_lib.html">Using the ZeppelinOS programmatic library</a></li></ul></div><div class="navGroup navGroupActive"><h3>ADVANCED TOPICS</h3><ul><li class="navListItem"><a class="navItem" href="/docs/faq.html">Frequently asked questions</a></li><li class="navListItem"><a class="navItem" href="/docs/configuration.html">Configuration Files</a></li><li class="navListItem"><a class="navItem" href="/docs/architecture.html">Contracts Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/pattern.html">ZeppelinOS Upgrades Pattern</a></li><li class="navListItem"><a class="navItem" href="/docs/token_mechanics.html">ZEP Token Mechanics</a></li><li class="navListItem"><a class="navItem" href="/docs/whitepaper.html">Whitepaper</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Linking to EVM packages</h1></header><article><div><span><p>ZeppelinOS allows us to link packages that have been already deployed
to the blockchain, instead of wasting resources deploying them again every time
we need them in a project. And of course, developers can upgrade their
packages and we can update our links to point to the newest versions, so we are
finally making an efficient use of all the developments in the community.</p>
<p>To use EVM packages we need first to initialize a ZeppelinOS project. Luckily,
we already have one after following the guide about
<a href="/docs/deploying.html">Deploying your first project</a>.</p>
<p>To continue with this exploration, let's write a new contract called
<code>MyLinkedContract.sol</code> and place it in the <code>contracts</code> folder. Then,
let's make it import a very common
contract from the <a href="https://openzeppelin.org/">OpenZeppelin</a> EVM package:</p>
<pre><code class="hljs css solidity">pragma solidity ^<span class="hljs-number">0</span>.<span class="hljs-number">5</span>.<span class="hljs-number">0</span><span class="hljs-comment">;</span>

import <span class="hljs-string">"openzeppelin-eth/contracts/token/ERC721/ERC721Mintable.sol"</span><span class="hljs-comment">;</span>

contract MyLinkedContract {
  ERC721Mintable private _token<span class="hljs-comment">;</span>

  function setToken(ERC721Mintable token) <span class="hljs-keyword">external </span>{
    require(<span class="hljs-keyword">address(token) </span>!= <span class="hljs-keyword">address(0));
</span>    _token = token<span class="hljs-comment">;</span>
  }
}
</code></pre>
<p>One thing to notice is that instead of importing <code>openzeppelin-solidity</code> we are
importing <code>openzeppelin-eth</code>. This is the name of the OpenZeppelin EVM package,
the one we have to use if we want to reuse the package already deployed.
For more information, see
<a href="https://blog.zeppelin.solutions/getting-started-with-openzeppelin-eth-a-new-stable-and-upgradeable-evm-package-576fb37297d0#125e">this article which explains the difference between openzeppelin-solidity and openzeppelin-eth</a>.</p>
<p>Now, let's link our project to the openzeppelin-eth package by running:</p>
<pre><code class="hljs css console">npx zos link openzeppelin-eth
</code></pre>
<p>This command will install the openzeppelin-eth contracts locally, which is
needed to compile the contracts that import it; but it will also update the
<code>zos.json</code> file with a reference to the linked package to make sure that when
you deploy the project it will use the EVM package that already exists on the
blockchain.</p>
<p>The following commands will be familiar to you. Just as we did before, we have
to add the contract to the project:</p>
<pre><code class="hljs css console">npx zos add MyLinkedContract
</code></pre>
<blockquote>
<p>If any of the following commands fail with an <code>A network name must be provided to execute the requested action</code> error, it means our session has expired.
In that case, renew it by running the command <code>npx zos session --network local --from 0x1df62f291b2e969fb0849d99d9ce41e2f137006e --expires 3600</code> again.</p>
</blockquote>
<p>Now, let's push our changes to the blockchain:</p>
<pre><code class="hljs css console">npx zos push --deploy-dependencies
</code></pre>
<p>There is one caveat here with the <code>--deploy-dependencies</code> flag. We mentioned
that this feature is about reusing packages that were already deployed, and we
do have already deployed versions of openzeppelin-eth and many other packages
to mainnet, ropsten, rinkeby and kovan. However, on this guide we are not using
any of those networks, instead we started a local development network with
Truffle that is empty. So, <code>--deploy-dependencies</code> tells ZeppelinOS to deploy
to the network the EVM packages we depend on. This has to be done only once,
so if you are using one of the real networks mentioned above, or you are
running the command again on the local network, this flag won't be needed.</p>
<p>Repeating ourselves from before, let's make an upgradeable instance of the
contract:</p>
<pre><code class="hljs css console">npx zos create MyLinkedContract
</code></pre>
<p>We also need an instance of the <code>ERC721</code> token from the EVM package:</p>
<pre><code class="hljs css console">npx zos create openzeppelin-eth/StandaloneERC721 --init initialize --args MyToken,TKN,[&lt;address&gt;],[&lt;address&gt;]
</code></pre>
<p><code>&lt;address&gt;</code> will be the minter and pauser of the token. For local development
you can use one of the 10 addresses that <code>ganache-cli</code> created by default.</p>
<p>Finally, we can start a new Truffle console to interact with our contract by running:</p>
<pre><code class="hljs css console">npx truffle console --network local
</code></pre>
<p>Now, let's jump to that Truffle console and connect our two deployed upgradeable contracts:</p>
<blockquote>
<p><em>Make sure you replace &lt;my-linked-contract-address&gt; and &lt;my-erc721-address&gt;
with the addresses of the upgradeable instances your created of <code>MyLinkedContract</code>
and <code>StandaloneERC721</code> respectively. Both addresses were returned by the <code>create</code>
commands we ran above.</em></p>
</blockquote>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> myLinkedContract = await MyLinkedContract.at(<span class="hljs-string">'&lt;my-linked-contract-address&gt;'</span>)</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> myLinkedContract.setToken(<span class="hljs-string">'&lt;my-erc721-address&gt;'</span>)</span>
</code></pre>
<p>Remember that the addresses of both your contract and the token, can also be
found in the <code>zos.dev-&lt;network_id&gt;.json</code> configuration file.</p>
<p>This is just the beginning of a better blockchain ecosystem, where developers
share their knowledge and their cool ideas in EVM packages, and we all
contribute by using and improving those packages. This soon will be a swarm of
packages that implement crazy new ways for a society to work, and they will all
be available for you to just link into your project and build on top of them.</p>
<p>But so far we have only seen the side of the users of EVM packages. I'm sure
you are now asking yourself how can you publish all the packages that you are
developing. That's what we'll explore next.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="upgrading.html">← Upgrading your project</a><a class="docs-next button" href="publishing.html">Publishing an EVM package →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/symbol-zeppelin.png" alt="ZeppelinOS" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/start.html">Guides</a><a href="/docs/apis.html">Reference</a></div><div><h5>Community</h5><a href="https://forum.zeppelin.solutions/" target="_blank">Forum</a><a href="https://t.me/zeppelinos/" target="_blank">Telegram chat</a></div><div><h5>More</h5><a href="https://zeppelinos.org">Main Site</a><a href="https://blog.zeppelinos.org">Blog</a><a href="https://github.com/zeppelinos">GitHub</a></div></section><a href="https://zeppelinos.org" target="_blank" class="fbOpenSource"><img src="/img/logo.svg" alt="ZeppelinOS" width="170" height="45"/></a><section class="copyright">Copyright © 2017-present ZeppelinOS Global</section><section class="report-bugs"><a href="https://github.com/zeppelinos/zos/issues/new?labels=kind:documentation">Report a bug on this site</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '8d0b5afbba49947d9efb5659d1b08df7',
                indexName: 'zeppelinos',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>